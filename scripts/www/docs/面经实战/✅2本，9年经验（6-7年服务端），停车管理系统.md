# 面试者背景


:::warning
**2本，9年经验（6-7年服务端），停车管理系统**

**停车管理系统干了多久？****1****年，管理****700+****停车场。系统是分布式的吗？**

**介绍下架构情况？接入层、网关、订单、支付、结算。**

**项目的难点是什么？数据一致性****(C)****，性能要求（****A****），如何保证****CA****呢？最终一致性**

**当前系统的性能要求是什么样的？入场性能要求更高，前置校验并发执行，策略模式、部分缓存，**

**高峰期****QPS 400****多，****RT 1.5s****，**

**当前支付方式都支持哪些？****wx****，****alipay****。如果要新增一种支付方式（比如****ETC****），需要哪些代码改动？设计方案、设计模式**

**如果极端的并发情况，比如****ETC****和手机支付同时发起，如何处理？订单主表、订单明细表，**

**结算系统介绍下？不需要分账。对账是谁和谁对？**

**如果一次付款包含积分和现金，结算这里是如何处理的？**

**涉及到营销打折么？没有营销账户出资，线下结算。**

**最终一致性都是通过****MQ****？有用过其他的一致性方案吗？**

**如何保证消息不丢？本地消息表、异步刷盘、**

**如果要做压测，怎么做？压测原因、压测过程，确定压测范围、准备压测数据****&****脚本****(****预发、线上****)****、执行压测，**

**你最后一次压测的数据：****QPS****（****600****）、****RT****（****tp99 1s****）、持续时长、失败率、以及其他的系统指标。**

**<font style="color:#000000;">压测600没问题，上线后300就扛不住了，可能是什么原因？</font>****冷启动（缓存预热、JIT优化、MQ堆积）、定时任务、全链路压测、外部系统影响、慢SQL（数据倾斜、数据堆积）、压测环境、其他接口QPS、其他基础设施？**

**对账是怎么做的？定时任务，拉支付订单数据，对比第三方渠道数据，**

**一天****200****万，靠定时任务对账？对比齐怎么处理？多次核对**

**分库分表是按照什么分的？时间+省份、全局ID、**

:::

# 题目解析




:::warning
**项目的难点是什么？数据一致性****(C)****，性能要求（****A****），如何保证****CA****呢？最终一致性**

**当前系统的性能要求是什么样的？入场性能要求更高，前置校验并发执行，策略模式、部分缓存，**

:::





[✅什么是CAP理论，为什么不能同时满足？](docs/分布式/✅什么是CAP理论，为什么不能同时满足？.md)





:::warning
**如果极端的并发情况，比如ETC和手机支付同时发起，如何处理？订单主表、订单明细表，**

:::



[✅一个支付单，多个渠道同时支付成功了怎么办？](docs/场景题/✅一个支付单，多个渠道同时支付成功了怎么办？.md)



:::warning
**结算系统介绍下？不需要分账。对账是谁和谁对？**

**如果一次付款包含积分和现金，结算这里是如何处理的？**

**涉及到营销打折么？没有营销账户出资，线下结算。**

:::







:::warning
**如何保证消息不丢？本地消息表、异步刷盘、**

:::



[✅RabbitMQ如何保证消息不丢](docs/RabbitMQ/✅RabbitMQ如何保证消息不丢.md)



[✅RocketMQ如何保证消息不丢失？](docs/RocketMQ/✅RocketMQ如何保证消息不丢失？.md)



[✅Kafka如何保证消息不丢失？](docs/Kafka/✅Kafka如何保证消息不丢失？.md)



:::warning
**如果要做压测，怎么做？压测原因、压测过程，确定压测范围、准备压测数据****&****脚本****(****预发、线上****)****、执行压测，**

**你最后一次压测的数据：****QPS****（****600****）、****RT****（****tp99 1s****）、持续时长、失败率、以及其他的系统指标。**

**<font style="color:#000000;">压测600没问题，上线后300就扛不住了，可能是什么原因？</font>****冷启动（缓存预热、JIT优化、MQ堆积）、定时任务、全链路压测、外部系统影响、慢SQL（数据倾斜、数据堆积）、压测环境、其他接口QPS、其他基础设施？**

:::



[✅什么是压测，怎么做压测？](docs/高可用/✅什么是压测，怎么做压测？.md)



[✅压测600没问题，上线后300就扛不住了，可能是什么原因？](docs/场景题/✅压测600没问题，上线后300就扛不住了，可能是什么原因？.md)



:::warning
**对账是怎么做的？定时任务，拉支付订单数据，对比第三方渠道数据，**

**一天200万，靠定时任务对账？对比齐怎么处理？多次核对**

:::



[✅怎么做数据对账？](docs/场景题/✅怎么做数据对账？.md)



:::warning
**分库分表是按照什么分的？时间+省份、全局ID、**

:::



[✅分表字段如何选择？](docs/分库分表/✅分表字段如何选择？.md)

